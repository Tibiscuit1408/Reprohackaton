gen <- read.table("GSE139659.csv", sep=";",header=T)
#Conversions of types
cols <- c("ctrl4", "ctrl5", "ctrl6", "IP1", "IP2", "IP3")
gen[cols] <- lapply(gen[cols], as.numeric)
data <- gen[, c("Name", "ctrl4", "ctrl5", "ctrl6", "IP1", "IP2", "IP3")]
#### Chargement de librairies
#source("http://bioconductor.org/biocLite.R")
#biocLite("limma")
library(limma) # necessaire pour la fonction "heatmap"
library(marray) # necessaire pour la fonction "maPalette"
#library(cluster)  ; library(geneplotter)
#library(marray) # necessaire pour le fonction "maPalette"
#### Classification of genes and individuals
#are there some genes that seem to be more expressed in some individuals?
heatmap(as.matrix(data),
distfun=function(data){as.dist(1-cor(t(data)))},
# définition de la distance utilisée "1-r"
hclustfun=function(distfun) hclust(distfun,method="ward.D2"),
# définition du critere d'aggregation ("ward.D2")
col= maPalette(low="green",high="red",mid="black"),
# choix des couleurs pour le heatmap
labRow= rownames(data),							# labels des lignes du heatmap
labCol=colnames(data),							# labels des colonnes du heatmap
keep.dendro=TRUE)										# visualisation des dendrogrammes
### Import data
gen <- read.table("GSE139659.csv", sep=";",header=T)
#Conversions of types
cols <- c("ctrl4", "ctrl5", "ctrl6", "IP1", "IP2", "IP3")
gen[cols] <- lapply(gen[cols], as.numeric)
data <- gen[, c("ctrl4", "ctrl5", "ctrl6", "IP1", "IP2", "IP3")]
#### Chargement de librairies
#source("http://bioconductor.org/biocLite.R")
#biocLite("limma")
library(limma) # necessaire pour la fonction "heatmap"
library(marray) # necessaire pour la fonction "maPalette"
#library(cluster)  ; library(geneplotter)
#library(marray) # necessaire pour le fonction "maPalette"
#### Classification of genes and individuals
#are there some genes that seem to be more expressed in some individuals?
heatmap(as.matrix(data),
distfun=function(data){as.dist(1-cor(t(data)))},
# définition de la distance utilisée "1-r"
hclustfun=function(distfun) hclust(distfun,method="ward.D2"),
# définition du critere d'aggregation ("ward.D2")
col= maPalette(low="green",high="red",mid="black"),
# choix des couleurs pour le heatmap
labRow= rownames(data),							# labels des lignes du heatmap
labCol=colnames(data),							# labels des colonnes du heatmap
keep.dendro=TRUE)										# visualisation des dendrogrammes
### Import data
gen <- read.table("GSE139659.csv", sep=";",header=T)
#Conversions of types
cols <- c("ctrl4", "ctrl5", "ctrl6", "IP1", "IP2", "IP3")
gen[cols] <- lapply(gen[cols], as.numeric)
data <- gen[, c("ctrl4", "ctrl5", "ctrl6", "IP1", "IP2", "IP3")]
data_filtered <- data[apply(data, 1, var, na.rm=TRUE) != 0, ]
data_filtered <- na.omit(data_filtered)
#### Chargement de librairies
#source("http://bioconductor.org/biocLite.R")
#biocLite("limma")
library(limma) # necessaire pour la fonction "heatmap"
library(marray) # necessaire pour la fonction "maPalette"
#library(cluster)  ; library(geneplotter)
#library(marray) # necessaire pour le fonction "maPalette"
#### Classification of genes and individuals
#are there some genes that seem to be more expressed in some individuals?
heatmap(as.matrix(data_filtered),
distfun=function(data){as.dist(1-cor(t(data)))},
# définition de la distance utilisée "1-r"
hclustfun=function(distfun) hclust(distfun,method="ward.D2"),
# définition du critere d'aggregation ("ward.D2")
col= maPalette(low="green",high="red",mid="black"),
# choix des couleurs pour le heatmap
labRow= rownames(data),							# labels des lignes du heatmap
labCol=colnames(data),							# labels des colonnes du heatmap
keep.dendro=TRUE)
data_filtered <- na.omit(data_scaled)
### Import data
gen <- read.table("GSE139659.csv", sep=";",header=T)
#Conversions of types
cols <- c("ctrl4", "ctrl5", "ctrl6", "IP1", "IP2", "IP3")
gen[cols] <- lapply(gen[cols], as.numeric)
data <- gen[, c("ctrl4", "ctrl5", "ctrl6", "IP1", "IP2", "IP3")]
data_filtered <- data[apply(data, 1, var, na.rm=TRUE) != 0, ]
data_scaled <- t(scale(t(data_filtered)))
data_filtered <- na.omit(data_scaled)
#### Chargement de librairies
#source("http://bioconductor.org/biocLite.R")
#biocLite("limma")
library(limma) # necessaire pour la fonction "heatmap"
library(marray) # necessaire pour la fonction "maPalette"
#library(cluster)  ; library(geneplotter)
#library(marray) # necessaire pour le fonction "maPalette"
#### Classification of genes and individuals
#are there some genes that seem to be more expressed in some individuals?
heatmap(as.matrix(data_filtered),
distfun=function(data){as.dist(1-cor(t(data)))},
# définition de la distance utilisée "1-r"
hclustfun=function(distfun) hclust(distfun,method="ward.D2"),
# définition du critere d'aggregation ("ward.D2")
col= maPalette(low="green",high="red",mid="black"),
# choix des couleurs pour le heatmap
labRow= rownames(data),							# labels des lignes du heatmap
labCol=colnames(data),							# labels des colonnes du heatmap
keep.dendro=TRUE)
### Load required libraries
library(DESeq2)
install.packages("DeSeq2")
### Load required libraries
library(DESeq2)
### Load required libraries
library(DESeq2)
install.packages("DeSeq2")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("DESeq2")*
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
### Load required libraries
library(DESeq2)
library(pheatmap)
library(RColorBrewer)
### 1. Import raw counts
# Rows = genes, columns = samples
counts <- read.table("GSE139659.csv", header=TRUE, row.names=1, sep=";")
### Load required libraries
library(DESeq2)
library(pheatmap)
library(RColorBrewer)
### 1. Import raw counts
# Rows = genes, columns = samples
counts <- read.table("GSE139659.csv", header=TRUE, sep=";")
### 2. Define sample information
# Example: 3 controls, 3 persisters
colData <- data.frame(
condition = factor(c("control", "control", "control",
"persister", "persister", "persister")),
row.names = colnames(counts)
)
### Load required libraries
library(DESeq2)
library(pheatmap)
library(RColorBrewer)
### Import raw counts
counts <- read.table("GSE139659.csv", header=TRUE, sep=";")
counts <- counts[, c("ctrl4", "ctrl5", "ctrl6", "IP1", "IP2", "IP3")]
### Définir les conditions
colData <- data.frame(
condition = factor(c("control", "control", "control",
"persister", "persister", "persister")),
row.names = colnames(counts)
)
### 3. Create DESeq2 dataset and run DE analysis
dds <- DESeqDataSetFromMatrix(countData = counts,
colData = colData,
design = ~ condition)
### Load required libraries
library(DESeq2)
library(pheatmap)
library(RColorBrewer)
### Import raw counts
counts <- read.table("GSE139659.csv", header=TRUE, sep=";")
counts_filtered <- counts[apply(data, 1, var, na.rm=TRUE) != 0, ]
counts_filtered <- na.omit(counts_filtered)
counts_filtered <- counts_filtered[, c("ctrl4", "ctrl5", "ctrl6", "IP1", "IP2", "IP3")]
### Définir les conditions
colData <- data.frame(
condition = factor(c("control", "control", "control",
"persister", "persister", "persister")),
row.names = colnames(counts)
)
### Load required libraries
library(DESeq2)
library(pheatmap)
library(RColorBrewer)
### Import raw counts
counts <- read.table("GSE139659.csv", header=TRUE, sep=";")
counts_filtered <- counts[apply(counts, 1, var, na.rm=TRUE) != 0, ]
counts_filtered <- na.omit(counts_filtered)
counts_filtered <- counts_filtered[, c("ctrl4", "ctrl5", "ctrl6", "IP1", "IP2", "IP3")]
### Définir les conditions
colData <- data.frame(
condition = factor(c("control", "control", "control",
"persister", "persister", "persister")),
row.names = colnames(counts)
)
### Load required libraries
library(DESeq2)
library(pheatmap)
library(RColorBrewer)
### Import raw counts
counts <- read.table("GSE139659.csv", header=TRUE, sep=";")
counts_filtered <- counts[apply(counts, 1, var, na.rm=TRUE) != 0, ]
counts_filtered <- na.omit(counts_filtered)
counts_filtered <- counts_filtered[, c("ctrl4", "ctrl5", "ctrl6", "IP1", "IP2", "IP3")]
### Définir les conditions
colData <- data.frame(
condition = factor(c("control", "control", "control", "persister", "persister", "persister")),
row.names = colnames(counts_filtered)
)
### 3. Create DESeq2 dataset and run DE analysis
dds <- DESeqDataSetFromMatrix(countData = counts_filtered,
colData = colData,
design = ~ condition)
dds <- DESeq(dds)
### 4. Apply variance stabilizing transformation
vsd <- vst(dds, blind = FALSE)   # or use varianceStabilizingTransformation(dds)
### 5. Extract top DEGs
res <- results(dds)
resOrdered <- res[order(res$padj), ]
DEGs <- subset(resOrdered, padj < 0.05 & abs(log2FoldChange) > 1)
# Keep only those genes in the VST data
vst_mat <- assay(vsd)[rownames(vsd) %in% rownames(DEGs), ]
### 6. Center and scale per gene (optional but recommended)
vst_mat_scaled <- t(scale(t(vst_mat)))
### 7. Plot the heatmap
annotation_col <- data.frame(Condition = colData$condition)
rownames(annotation_col) <- rownames(colData)
pheatmap(vst_mat_scaled,
annotation_col = annotation_col,
show_rownames = FALSE,
color = colorRampPalette(rev(brewer.pal(9, "RdYlGn")))(255),
clustering_distance_rows = "correlation",
clustering_distance_cols = "correlation",
clustering_method = "ward.D2",
main = "Hierarchical clustering of DEGs (VST-normalized)")
### Load required libraries
library(DESeq2)
library(pheatmap)
library(RColorBrewer)
### Import raw counts
counts <- read.table("GSE139659.csv", header=TRUE, sep=";")
counts_filtered <- counts[apply(counts, 1, var, na.rm=TRUE) != 0, ]
counts_filtered <- na.omit(counts_filtered)
counts_filtered <- counts_filtered[, c("ctrl4", "ctrl5", "ctrl6", "IP1", "IP2", "IP3")]
### Define conditions
colData <- data.frame(
condition = factor(c("control", "control", "control", "persister", "persister", "persister")),
row.names = colnames(counts_filtered)
)
### Create DESeq2 dataset and run DE analysis
dds <- DESeqDataSetFromMatrix(countData = counts_filtered,
colData = colData,
design = ~ condition)
dds <- DESeq(dds)
### Apply variance stabilizing transformation
vsd <- vst(dds, blind = FALSE)
### Extraction of top DEGs
res <- results(dds)
resOrdered <- res[order(res$padj), ]
DEGs <- subset(resOrdered, padj < 0.05 & abs(log2FoldChange) > 1)
# Keep only genes in the VST data
vst_mat <- assay(vsd)[rownames(vsd) %in% rownames(DEGs), ]
### Center and scale per gene (optional but recommended)
vst_mat_scaled <- t(scale(t(vst_mat)))
### Plot the heatmap
annotation_col <- data.frame(Condition = colData$condition)
rownames(annotation_col) <- rownames(colData)
my_colors <- colorRampPalette(c("lightblue", "white", "salmon"))(255)
pheatmap(vst_mat_scaled,
annotation_col = annotation_col,
show_rownames = FALSE,
color = my_colors,
clustering_distance_rows = "correlation",
clustering_distance_cols = "correlation",
clustering_method = "ward.D2",
main = "Hierarchical clustering of DEGs (VST-normalized)")
### Plot the heatmap
annotation_col <- data.frame(Condition = colData$condition)
rownames(annotation_col) <- rownames(colData)
my_colors <- colorRampPalette(c("blue", "white", "orange"))(255)
pheatmap(vst_mat_scaled,
annotation_col = annotation_col,
show_rownames = FALSE,
color = my_colors,
clustering_distance_rows = "correlation",
clustering_distance_cols = "correlation",
clustering_method = "ward.D2",
main = "Hierarchical clustering of DEGs (VST-normalized)")
### Plot the heatmap
annotation_col <- data.frame(Condition = colData$condition)
rownames(annotation_col) <- rownames(colData)
my_colors <- colorRampPalette(c("deepskyblue4", "azure", "coral2"))(255)
pheatmap(vst_mat_scaled,
annotation_col = annotation_col,
show_rownames = FALSE,
color = my_colors,
clustering_distance_rows = "correlation",
clustering_distance_cols = "correlation",
clustering_method = "ward.D2",
main = "Hierarchical clustering of DEGs (VST-normalized)")
### Plot the heatmap
annotation_col <- data.frame(Condition = colData$condition)
rownames(annotation_col) <- rownames(colData)
my_colors <- colorRampPalette(c("deepskyblue4", "azure", "darkorange2"))(255)
pheatmap(vst_mat_scaled,
annotation_col = annotation_col,
show_rownames = FALSE,
color = my_colors,
clustering_distance_rows = "correlation",
clustering_distance_cols = "correlation",
clustering_method = "ward.D2",
main = "Hierarchical clustering of DEGs (VST-normalized)")
View(dds)
### Load required libraries
library(DESeq2)
library(pheatmap)
library(RColorBrewer)
### Import raw counts
#counts <- read.table("GSE139659.csv", header=TRUE, sep=";")
counts <- read.table("all_samples_gene_counts.txt", header=TRUE, sep=" ")
counts_filtered <- counts[apply(counts, 1, var, na.rm=TRUE) != 0, ]
counts_filtered <- na.omit(counts_filtered)
counts_filtered <- counts_filtered[, c("ctrl4", "ctrl5", "ctrl6", "IP1", "IP2", "IP3")]
View(counts)
### Load required libraries
library(DESeq2)
library(pheatmap)
library(RColorBrewer)
### Import raw counts
#counts <- read.table("GSE139659.csv", header=TRUE, sep=";")
counts <- read.table("all_samples_gene_counts.txt",header = TRUE,sep = "\t",comment.char = "#")
counts_filtered <- counts[apply(counts, 1, var, na.rm=TRUE) != 0, ]
counts_filtered <- na.omit(counts_filtered)
# Sélection des 5 dernières colonnes
sample_data <- counts[, (ncol(gen)-4):ncol(gen)]
warnings()
### Load required libraries
library(DESeq2)
library(pheatmap)
library(RColorBrewer)
### Import raw counts
#counts <- read.table("GSE139659.csv", header=TRUE, sep=";")
counts <- read.table("all_samples_gene_counts.txt",header = TRUE,sep = "\t",comment.char = "#")
counts_filtered <- counts[apply(counts, 1, var, na.rm=TRUE) != 0, ]
counts_filtered <- na.omit(counts_filtered)
# Sélection des 5 dernières colonnes
sample_data <- counts[,c(7:ncol(gen))]
### Load required libraries
library(DESeq2)
library(pheatmap)
library(RColorBrewer)
### Import raw counts
#counts <- read.table("GSE139659.csv", header=TRUE, sep=";")
counts <- read.table("all_samples_gene_counts.txt",header = TRUE,sep = "\t",comment.char = "#")
counts_filtered <- counts[apply(counts, 1, var, na.rm=TRUE) != 0, ]
counts_filtered <- na.omit(counts_filtered)
# Sélection des 6 dernières colonnes
sample_data <- counts[,c(6:ncol(counts_filtered))]
### Define conditions
colData <- data.frame(
condition = factor(c("control", "control", "control", "persister", "persister", "persister")),
row.names = colnames(counts_filtered)
)
### Load required libraries
library(DESeq2)
library(pheatmap)
library(RColorBrewer)
### Import raw counts
#counts <- read.table("GSE139659.csv", header=TRUE, sep=";")
counts <- read.table("all_samples_gene_counts.txt",header = TRUE,sep = "\t",comment.char = "#")
counts_filtered <- counts[apply(counts, 1, var, na.rm=TRUE) != 0, ]
counts_filtered <- na.omit(counts_filtered)
# Sélection des 6 dernières colonnes
sample_data <- counts[,c(6:ncol(counts_filtered))]
### Define conditions
colData <- data.frame(
condition = factor(c("control", "control", "control", "persister", "persister", "persister")),
row.names = colnames(sample_data)
)
sample_data <- counts[,c(6:ncol(counts_filtered))]
sample_data.size()
sample_data <- counts[,c(6:ncol(counts_filtered))]
len(sample_data)
sample_data <- counts[,c(6:ncol(counts_filtered))]
length(sample_data)
# Sélection des 6 dernières colonnes
sample_data <- counts[,c(6:ncol(counts_filtered))]
shape(sample_data)
sample_data <- counts[,c(7:ncol(counts_filtered))]
len(sample_data)
### Load required libraries
library(DESeq2)
library(pheatmap)
library(RColorBrewer)
### Import raw counts
#counts <- read.table("GSE139659.csv", header=TRUE, sep=";")
counts <- read.table("all_samples_gene_counts.txt",header = TRUE,sep = "\t",comment.char = "#")
counts_filtered <- counts[apply(counts, 1, var, na.rm=TRUE) != 0, ]
counts_filtered <- na.omit(counts_filtered)
# Sélection des 6 dernières colonnes
sample_data <- counts[,c(7:ncol(counts_filtered))]
### Define conditions
colData <- data.frame(
condition = factor(c("control", "control", "control", "persister", "persister", "persister")),
row.names = colnames(sample_data)
)
### Create DESeq2 dataset and run DE analysis
dds <- DESeqDataSetFromMatrix(countData = counts_filtered,
colData = colData,
design = ~ condition)
### Load required libraries
library(DESeq2)
library(pheatmap)
library(RColorBrewer)
### Import raw counts
#counts <- read.table("GSE139659.csv", header=TRUE, sep=";")
counts <- read.table("all_samples_gene_counts.txt",header = TRUE,sep = "\t",comment.char = "#")
counts_filtered <- counts[apply(counts, 1, var, na.rm=TRUE) != 0, ]
counts_filtered <- na.omit(counts_filtered)
# Sélection des 6 dernières colonnes
sample_data <- counts[,c(7:ncol(counts_filtered))]
### Define conditions
colData <- data.frame(
condition = factor(c("control", "control", "control", "persister", "persister", "persister")),
row.names = colnames(sample_data)
)
### Create DESeq2 dataset and run DE analysis
dds <- DESeqDataSetFromMatrix(countData = sample_data,
colData = colData,
design = ~ condition)
dds <- DESeq(dds)
### Apply variance stabilizing transformation
vsd <- vst(dds, blind = FALSE)
### Extraction of top DEGs
res <- results(dds)
resOrdered <- res[order(res$padj), ]
DEGs <- subset(resOrdered, padj < 0.05 & abs(log2FoldChange) > 1)
# Keep only genes in the VST data
vst_mat <- assay(vsd)[rownames(vsd) %in% rownames(DEGs), ]
### Center and scale per gene (optional but recommended)
vst_mat_scaled <- t(scale(t(vst_mat)))
### Plot the heatmap
annotation_col <- data.frame(Condition = colData$condition)
rownames(annotation_col) <- rownames(colData)
my_colors <- colorRampPalette(c("deepskyblue4", "azure", "darkorange2"))(255)
pheatmap(vst_mat_scaled,
annotation_col = annotation_col,
show_rownames = FALSE,
color = my_colors,
clustering_distance_rows = "correlation",
clustering_distance_cols = "correlation",
clustering_method = "ward.D2",
main = "Hierarchical clustering of DEGs (VST-normalized)")
nrow(DEGs)
str(sample_data)
DEGs <- subset(resOrdered, padj < 0.1 & abs(log2FoldChange) > 0.5)
# Keep only genes in the VST data
vst_mat <- assay(vsd)[rownames(vsd) %in% rownames(DEGs), ]
### Center and scale per gene (optional but recommended)
vst_mat_scaled <- t(scale(t(vst_mat)))
### Plot the heatmap
annotation_col <- data.frame(Condition = colData$condition)
rownames(annotation_col) <- rownames(colData)
my_colors <- colorRampPalette(c("deepskyblue4", "azure", "darkorange2"))(255)
pheatmap(vst_mat_scaled,
annotation_col = annotation_col,
show_rownames = FALSE,
color = my_colors,
clustering_distance_rows = "correlation",
clustering_distance_cols = "correlation",
clustering_method = "ward.D2",
main = "Hierarchical clustering of DEGs (VST-normalized)")
nrow(DEGs)
### Extraction of top DEGs
res <- results(dds)
resOrdered <- res[order(res$padj), ]
DEGs <- subset(resOrdered, padj < 0.1 & abs(log2FoldChange) > 0.1)
# Keep only genes in the VST data
vst_mat <- assay(vsd)[rownames(vsd) %in% rownames(DEGs), ]
### Center and scale per gene (optional but recommended)
vst_mat_scaled <- t(scale(t(vst_mat)))
### Plot the heatmap
annotation_col <- data.frame(Condition = colData$condition)
rownames(annotation_col) <- rownames(colData)
my_colors <- colorRampPalette(c("deepskyblue4", "azure", "darkorange2"))(255)
pheatmap(vst_mat_scaled,
annotation_col = annotation_col,
show_rownames = FALSE,
color = my_colors,
clustering_distance_rows = "correlation",
clustering_distance_cols = "correlation",
clustering_method = "ward.D2",
main = "Hierarchical clustering of DEGs (VST-normalized)")
head(res)
library(DESeq2)
library(pheatmap)
library(RColorBrewer)
### Import raw counts
#counts <- read.table("GSE139659.csv", header=TRUE, sep=";")
counts <- read.table("all_samples_gene_counts.txt",header = TRUE,sep = "\t",comment.char = "#")
#Rename the columns of the data
colnames(counts)[colnames(counts) == "SRR10379726_1_trimmed_mapped.sam"] <- "control"
colnames(counts)[colnames(counts) == "SRR10379723_1_trimmed_mapped.sam"] <- "persister"
colnames(counts)[colnames(counts) == "SRR10379722_1_trimmed_mapped.sam"] <- "persister"
colnames(counts)[colnames(counts) == "SRR10379724_1_trimmed_mapped.sam"] <- "control"
colnames(counts)[colnames(counts) == "SRR10379725_1_trimmed_mapped.sam"] <- "control"
colnames(counts)[colnames(counts) == "SRR10379721_1_trimmed_mapped.sam"] <- "persister"
counts_filtered <- counts[apply(counts, 1, var, na.rm=TRUE) != 0, ]
counts_filtered <- na.omit(counts_filtered)
# Sélection des 6 dernières colonnes
sample_data <- counts[,c(7:ncol(counts_filtered))]
### Define conditions
colData <- data.frame(
condition = colnames(sample_data),
row.names = colnames(sample_data)
)
### Create DESeq2 dataset and run DE analysis
dds <- DESeqDataSetFromMatrix(countData = sample_data,
colData = colData,
design = ~ condition)
dds <- DESeq(dds)
